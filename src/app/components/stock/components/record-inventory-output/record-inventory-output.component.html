<div class="stock-outflow-container scroll-y">
    <div class="form-header-content">
        <h1>Registrar Salida de Stock</h1>
        <p>Complete los campos para registrar ventas o mermas y actualizar el inventario</p>
    </div>

    <form [formGroup]="recordOuputInventoryForm" class="mt-1">
        <div class="form-grid">
            <div class="form-field full-width">
                <label for="outflowType" class="required">Tipo de Salida</label>
                <select id="outflowType" formControlName="outflowType" required>
                    <option value="" disabled selected>Seleccione el tipo de salida</option>
                    <option value="venta">Venta</option>
                    <option value="merma">Merma</option>
                </select>
            </div>

            <div class="form-field full-width">
                <label for="product" class="required">Producto</label>
                <select id="product" formControlName="nameProduct" required>
                    <option value="" disabled selected>Buscar y seleccionar producto</option>
                    <option value="1">Manzanas Orgánicas Fuji</option>
                    <option value="2">Leche Entera 1L</option>
                    <option value="3">Pan Integral 500g</option>
                    <option value="4">Arroz Blanco 1kg</option>
                </select>
            </div>

            <div class="form-field">
                <label for="currentStock" class="required">Stock Actual</label>
                <input type="number" id="currentStock" readonly value="0" disabled>
                <div class="help-text">Stock disponible en el sistema</div>
            </div>

            <div class="form-field">
                <label for="quantity" class="required">Cantidad a Retirar</label>
                <input type="number" formControlName="quantitySale" id="quantity" placeholder="Ej: 5" min="1" required>
            </div>

            <div class="form-field" id="mermaReasonField" style="display: none;">
                <label for="mermaReason" class="required">Motivo de Merma</label>
                <select id="mermaReason" formControlName="mermaReason">
                    <option value="" disabled selected>Seleccione el motivo</option>
                    <option value="dañado">Producto Dañado</option>
                    <option value="caducado">Producto Caducado</option>
                    <option value="robado">Producto Robado/Extraviado</option>
                    <option value="calidad">Problemas de Calidad</option>
                    <option value="otro">Otro</option>
                </select>
            </div>

            <div class="form-field" id="salesPriceField">
                <label for="salePrice" class="required">Precio de Venta</label>
                <div class="input-group">
                    <span class="input-group-prefix">$</span>
                    <input type="number" id="salePrice" formControlName="salePrice" placeholder="0.00" step="0.01" min="0" required>
                </div>
            </div>

            <div class="form-field full-width">
                <label for="observations">Observaciones</label>
                <textarea id="observations" formControlName="observations" placeholder="Detalles adicionales sobre esta salida de stock"></textarea>
            </div>

            <div class="form-field full-width" id="mermaDetailsField" style="display: none;">
                <label for="mermaDetails" class="required">Detalles de la Merma</label>
                <textarea id="mermaDetails" formControlName="mermaDetails" placeholder="Describa en detalle la razón de la merma y cualquier acción tomada"></textarea>
            </div>

            <div class="form-field">
                <label for="date" class="required">Fecha</label>
                <input type="date" formControlName="dateSale" [value]="today | date:'yyyy-MM-dd'"  [min]="today | date:'yyyy-MM-dd'" id="date" required>
            </div>

            <div class="form-field">
                <label for="documentNumber">N° de Documento</label>
                <input type="text" id="documentNumber" formControlName="documentNumber" placeholder="Factura, boleta, etc." required>
                <div class="help-text">Opcional, referencia del documento</div>
            </div>

            <div class="form-buttons full-width">
                <button type="button" class="btn-app btn-app-secondary">Cancelar</button>
                <button type="submit" class="btn-app btn-app-primary" (click)="getFormValue()">Registrar Salida</button>
            </div>
        </div>
    </form>

    <div class="notice">
        <strong>Importante:</strong> Al registrar una venta o merma, el stock disponible se actualizará automáticamente. Esta acción no se puede deshacer directamente.
    </div>
</div>

